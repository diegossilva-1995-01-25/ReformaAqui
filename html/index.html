<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link type="text/css" rel="stylesheet" href="../html/css/estilo.css">
    <meta charset="utf-8">
    <title>Reforma Aqui</title>

    <script type="text/javascript">

      var cookiesConvertidos = decodeURIComponent(document.cookie);
      var vetorCookies = cookiesConvertidos.split('; ');

      var cCpf = vetorCookies[0];
      var cNome = vetorCookies[1];
      var cEmail = vetorCookies[2];
      var cTipo = vetorCookies[3];

      $(document).ready(function() {

        if (cNome != null && cNome != "") {

          cCpf = cCpf.substring(cCpf.indexOf("=") + 1);
          cNome = cNome.substring(cNome.indexOf("=") + 1);
          cEmail = cEmail.substring(cEmail.indexOf("=") + 1);
          cTipo = cTipo.substring(cTipo.indexOf("=") + 1);

          $("div.cornerDiv")
            .html("<label class=\"welcome\">Seja bem-vindo, " + cNome +
            " </label> <a class=\"welcome\" href=\"../" + cTipo + "\">Alterar</a> <a class=\"welcome\" href=\"../logoff\">Sair</a>");

          if (cTipo == "autonomo") {
            $("body").append("<div class=\"formDiv\"><a href=\"../orcamento\">Criar orçamento</a></div><br>");

          } else {
            $("body").append("<div class=\"formDiv\"><a href=\"../solicitacaoorcamento\">Solicitar orçamento</a></div><br><br>");

          }

        }

        // Pegar todos os autonomos
        $.get("../autonomo/all", function (dados) {

          var tabelaHTML = "";

          tabelaHTML = tabelaHTML + " <div class=\"formDiv\"> <table class=\"tabela\"> <thead>" +
            " <tr> <th> E-mail </th> <th> Nome </th> <th> Bairro </th> <th> Telefone </th> <th> Celular </th> <th> Função </th> </tr>" +
            " </thead>" +
            "<tbody>";

          for (var i in dados) {
            tabelaHTML = tabelaHTML + "<tr>" + "<td>" + dados[i].email + "</td>" +
              "<td>" + dados[i].nome + "</td>" +
              "<td>" + dados[i].bairro + "</td>" +
              "<td>" + dados[i].telefone + "</td>" +
              "<td>" + dados[i].celular + "</td>" +
              "<td>" + dados[i].funcaoPrimaria + "</td>" + "</tr>";
          }

          tabelaHTML = tabelaHTML + "</tbody> </table> </div>";

          $("body").append(tabelaHTML);

        });

      });

    </script>

  </head>

  <body>

    <a href="../" class="logo">
      <div>
        <img class="icone" src="../html/css/iconTCC.png" alt="ReformaAqui">
        <label>ReformaAqui</label>
      </div>
    </a>

    <div class="cornerDiv">
      <label class="welcome">Quem é você? É novo por aqui? </label>
      <a class="welcome" href="../login">Entrar </a>
    </div>

    <br>
    <br>

    <h1>ReformaAqui</h1>

    <br>
    <br>


    <!--
      Mostre o orçamento que for enviado.
    -->
    <!--
      Orçamentos que surgiram com o cliente ou solicitações ao autônomo
    -->
    <!--
      Insira aqui a tabela com todos os autônomos ordenados pelo número de estrelas
      e se o cliente desejar, em tal bairro.
    -->




  </body>

</html>
